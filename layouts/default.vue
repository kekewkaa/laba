<template>
  <div>
    <!-- –®–ê–ü–ö–ê -->
    <header
      class="flex flex-col md:flex-row items-center md:justify-between w-full bg-indigo-700 text-white px-6 py-4 shadow-lg relative"
    >
      <!-- –õ–æ–≥–æ—Ç–∏–ø -->
      <div class="flex items-center gap-3 mb-3 md:mb-0">
        <!-- –ª–æ–≥–æ—Ç–∏–ø –æ—Å—Ç–∞—ë—Ç—Å—è logo.png -->
        <img
          src="/images/logo.png"
          class="w-16 h-16 rounded-full border-2 border-white shadow-sm"
          alt="Logo"
        />
        <div class="flex flex-col">
          <span class="text-2xl font-extrabold tracking-wide">Amira Project</span>
          <span class="text-sm text-indigo-200 italic">—Å–∞–π—Ç –æ –ë–∞—Ä—Å–∏–∫–µ üêæ</span>
        </div>
      </div>

      <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è (–¥–µ—Å–∫—Ç–æ–ø) -->
      <nav class="hidden md:flex flex-row items-center gap-4 relative z-50">
        <NuxtLink
          to="/"
          class="px-3 py-2 rounded hover:bg-indigo-500 transition-colors"
          >–ì–ª–∞–≤–Ω–∞—è</NuxtLink
        >

        <!-- –ì–∞–ª–µ—Ä–µ—è -->
        <div class="relative">
          <button
            @click="toggleLabsDesktop"
            class="px-3 py-2 rounded hover:bg-indigo-500 transition-colors flex items-center gap-1"
          >
            –§–æ—Ç–æ –∏ –í–∏–¥–µ–æ
            <span v-if="labsDesktopOpen">‚ñæ</span>
            <span v-else>‚ñ∏</span>
          </button>

          <transition name="slide-fade">
            <div
              v-if="labsDesktopOpen"
              class="absolute bg-white text-gray-800 mt-2 rounded shadow-lg w-40 z-50"
            >
              <NuxtLink to="/photos" class="block px-4 py-2 hover:bg-gray-100"
                >–§–æ—Ç–æ –ë–∞—Ä—Å–∏–∫–∞</NuxtLink
              >
              <NuxtLink to="/videos" class="block px-4 py-2 hover:bg-gray-100"
                >–ò–≥—Ä–∞ —Å –ë–∞—Ä—Å–∏–∫–æ–º</NuxtLink
              >
            </div>
          </transition>
        </div>

        <NuxtLink
          to="/login"
          class="px-3 py-2 rounded hover:bg-indigo-500 transition-colors"
          >LogIn</NuxtLink
        >
        <NuxtLink
          to="/logout"
          class="px-3 py-2 rounded hover:bg-indigo-500 transition-colors"
          >LogOut</NuxtLink
        >
      </nav>

      <!-- –ö–Ω–æ–ø–∫–∞ –±—É—Ä–≥–µ—Ä (–º–æ–±–∏–ª–∫–∞) -->
      <button @click="toggleBurger" class="md:hidden p-2 bg-indigo-600 rounded">
        <span v-if="!burger">‚ò∞</span>
        <span v-else>‚úñÔ∏è</span>
      </button>
    </header>

    <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
    <transition name="slide-fade">
      <nav
        v-if="burger"
        class="md:hidden flex flex-col bg-indigo-600 text-white"
      >
        <NuxtLink
          to="/"
          class="px-4 py-3 border-t border-indigo-500 hover:bg-indigo-500"
          >–ì–ª–∞–≤–Ω–∞—è</NuxtLink
        >

        <!-- –ü–æ–¥–º–µ–Ω—é –§–æ—Ç–æ –∏ –í–∏–¥–µ–æ -->
        <button
          @click="toggleLabs"
          class="flex justify-between items-center px-4 py-3 border-t border-indigo-500"
        >
          <span>–§–æ—Ç–æ –∏ –í–∏–¥–µ–æ</span>
          <span v-if="labsOpen">‚ñæ</span>
          <span v-else>‚ñ∏</span>
        </button>

        <div v-if="labsOpen" class="flex flex-col bg-indigo-700">
          <NuxtLink
            to="/photos"
            class="px-6 py-2 border-t border-indigo-500 hover:bg-indigo-500"
            >–§–æ—Ç–æ –ë–∞—Ä—Å–∏–∫–∞</NuxtLink
          >
          <!-- –í–º–µ—Å—Ç–æ –í–∏–¥–µ–æ –∏ –ê—É–¥–∏–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã "–û –ë–∞—Ä—Å–∏–∫–µ" –∏ "–ö–æ–Ω—Ç–∞–∫—Ç—ã" -->
          <NuxtLink
            to="/about"
            class="px-6 py-2 border-t border-indigo-500 hover:bg-indigo-500"
            >–û –ë–∞—Ä—Å–∏–∫–µ</NuxtLink
          >
          <NuxtLink
            to="/contact"
            class="px-6 py-2 border-t border-indigo-500 hover:bg-indigo-500"
            >–ö–æ–Ω—Ç–∞–∫—Ç—ã</NuxtLink
          >
        </div>

        <NuxtLink
          to="/login"
          class="px-4 py-3 border-t border-indigo-500 hover:bg-indigo-500"
          >LogIn</NuxtLink
        >
        <NuxtLink
          to="/logout"
          class="px-4 py-3 border-t border-indigo-500 hover:bg-indigo-500"
          >LogOut</NuxtLink
        >
      </nav>
    </transition>

    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="p-6 max-w-5xl mx-auto">
      <slot />
    </main>
  </div>
</template>

<script setup>
import { ref, onMounted, onBeforeUnmount } from "vue"

const burger = ref(false)
const labsOpen = ref(false)
const labsDesktopOpen = ref(false)

function toggleBurger() {
  burger.value = !burger.value
  if (!burger.value) labsOpen.value = false
}

function toggleLabs() {
  labsOpen.value = !labsOpen.value
}

function toggleLabsDesktop() {
  labsDesktopOpen.value = !labsDesktopOpen.value
}

function handleClickOutside(event) {
  const dropdown = document.querySelector(".relative")
  if (dropdown && !dropdown.contains(event.target)) {
    labsDesktopOpen.value = false
  }
}

onMounted(() => document.addEventListener("click", handleClickOutside))
onBeforeUnmount(() => document.removeEventListener("click", handleClickOutside))
</script>

<style scoped>
a:hover {
  cursor: pointer;
}

.slide-fade-enter-active,
.slide-fade-leave-active {
  transition: all 0.2s ease;
}
.slide-fade-enter-from,
.slide-fade-leave-to {
  opacity: 0;
  transform: translateY(-10px);
}
</style>
